import pandas as pd

# Identify categorical columns
categorical_cols = df.select_dtypes(include=['object']).columns

# Exclude the target variable 'y' from one-hot encoding if it's in categorical_cols
# It will be handled separately
if 'y' in categorical_cols:
    categorical_cols = categorical_cols.drop('y')

# Apply one-hot encoding to categorical columns
df_encoded = pd.get_dummies(df, columns=categorical_cols, drop_first=False)

# Convert the target variable 'y' to numerical (1 for 'yes', 0 for 'no')
df_encoded['y'] = df_encoded['y'].map({'yes': 1, 'no': 0})

# Separate features (X) and target variable (y)
X = df_encoded.drop('y', axis=1)
y = df_encoded['y']

print("Shape of X (features):")
print(X.shape)
print("\nShape of y (target):")
print(y.shape)

print("\nFirst 5 rows of X:")
print(X.head())
print("\nFirst 5 values of y:")
print(y.head())